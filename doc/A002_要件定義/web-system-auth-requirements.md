# Webシステム - アカウント作成・ログイン要件

## 1. アカウント作成要件

### 1.1 必須項目
- **ユーザー名**
  - 3-20文字以内
  - 英数字とアンダースコア(_)のみ許可
  - 一意性の確保
- **メールアドレス**
  - 有効なメールアドレス形式
  - 一意性の確保
  - メール認証必須
- **パスワード**
  - 8文字以上
  - 英大文字・小文字・数字・記号を各1文字以上含む
  - よく使われるパスワードの使用禁止

### 1.2 任意項目
- 氏名（姓・名）
- 生年月日
- 電話番号

### 1.3 セキュリティ要件
- メール認証による本人確認
- CSRF保護
- レート制限（同一IPから1時間に5回まで）
- パスワードハッシュ化（bcrypt使用）
- 利用規約・プライバシーポリシーへの同意

## 2. ログイン要件

### 2.1 認証方法
- **メールアドレス + パスワード**
- **ユーザー名 + パスワード**

### 2.2 セキュリティ機能
- **アカウントロック**
  - 5回連続失敗で30分間ロック
  - ロック解除はメール認証または管理者による手動解除
- **セッション管理**
  - セッション有効期限：24時間
  - 非アクティブ時の自動ログアウト：2時間
  - 複数デバイスからの同時ログイン可能
- **二要素認証（2FA）**
  - TOTP（Time-based One-Time Password）対応
  - SMS認証対応
  - 管理者による強制有効化オプション

### 2.3 ユーザビリティ
- **ログイン状態保持**
  - "ログイン状態を保持" チェックボックス
  - 有効時は30日間ログイン状態維持
- **パスワードリセット**
  - メール経由でのパスワードリセット
  - リセットリンク有効期限：1時間
- **ログイン履歴**
  - 最新10件のログイン履歴表示
  - IP アドレス・デバイス情報・日時を記録

## 3. 技術要件

### 3.1 パフォーマンス
- ログインレスポンス時間：1秒以内
- アカウント作成レスポンス時間：2秒以内
- 同時ログインユーザー：1000人まで対応

### 3.2 データ保護
- 個人情報の暗号化保存
- ログの適切な管理（個人情報の匿名化）
- GDPR準拠（データ削除権・ポータビリティ権）

### 3.3 API要件
- RESTful API設計
- JWT認証対応
- API レート制限
- OpenAPI仕様書の提供

## 4. 監査・ログ要件

### 4.1 記録対象
- アカウント作成
- ログイン成功・失敗
- パスワード変更
- アカウントロック・解除
- 管理者操作

### 4.2 ログ保存期間
- セキュリティログ：1年間
- 操作ログ：6ヶ月間
- エラーログ：3ヶ月間

## 5. ブラウザ対応

### 5.1 対応ブラウザ
- Chrome（最新版含む過去2バージョン）
- Firefox（最新版含む過去2バージョン）
- Safari（最新版含む過去2バージョン）
- Edge（最新版含む過去2バージョン）

### 5.2 モバイル対応
- レスポンシブデザイン
- iOS Safari / Android Chrome 対応
- タッチ操作最適化

## 6. アクセシビリティ

- WCAG 2.1 AA レベル準拠
- スクリーンリーダー対応
- キーボードナビゲーション対応
- 十分なコントラスト比の確保